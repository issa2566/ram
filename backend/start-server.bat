@echo off
chcp 65001 > nul
cls

echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo     ๐ ุชุดุบูู ุฎุงุฏู Node.js ูุน PostgreSQL
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo.

REM ุงูุชุญูู ูู ูุฌูุฏ Node.js
where node >nul 2>nul
if %ERRORLEVEL% NEQ 0 (
    echo โ Node.js ุบูุฑ ูุซุจุช!
    echo ๐ก ูู ุจุชุซุจูุช Node.js ูู: https://nodejs.org/
    echo.
    pause
    exit /b 1
)

REM ุงูุชุญูู ูู ูุฌูุฏ node_modules
if not exist "node_modules\" (
    echo ๐ฆ ุชุซุจูุช ุงูููุชุจุงุช ุงููุทููุจุฉ...
    call npm install
    if %ERRORLEVEL% NEQ 0 (
        echo โ ูุดู ุชุซุจูุช ุงูููุชุจุงุช!
        pause
        exit /b 1
    )
    echo โ ุชู ุชุซุจูุช ุงูููุชุจุงุช ุจูุฌุงุญ
    echo.
)

REM ุงุฎุชุจุงุฑ ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช
echo ๐ ุงุฎุชุจุงุฑ ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช...
call npm run test:db
if %ERRORLEVEL% NEQ 0 (
    echo.
    echo โ๏ธ  ุชุญุฐูุฑ: ูุดู ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช
    echo ๐ก ุชุฃูุฏ ูู:
    echo    1. ุชุดุบูู PostgreSQL
    echo    2. ุฅูุดุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช testdb
    echo    3. ุชูููุฐ ููู database.sql
    echo.
    echo ูู ุชุฑูุฏ ุงููุชุงุจุนุฉ ุฑุบู ุฐููุ (Y/N)
    set /p continue=
    if /i not "%continue%"=="Y" exit /b 1
)

echo.
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo ๐ ุชุดุบูู ุงูุฎุงุฏู...
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo.
echo ๐ ุงูุฎุงุฏู ุณูุนูู ุนูู: http://69.169.108.182:3000
echo ๐ ูุฅููุงู ุงูุฎุงุฏูุ ุงุถุบุท: Ctrl+C
echo.

REM ุชุดุบูู ุงูุฎุงุฏู
call npm start

