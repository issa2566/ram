@echo off
chcp 65001 > nul
color 0A
cls

echo.
echo    โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo    โ                                                       โ
echo    โ         ๐ง ุฅุตูุงุญ ูุดููุฉ ุฃููููุฉ ุงูููู ูููุฏูุฑ         โ
echo    โ                                                       โ
echo    โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo.

echo    [1/5] ุฅููุงู ุงูุนูููุงุช ุงููุฏููุฉ...
taskkill /f /im node.exe >nul 2>&1
timeout /t 2 /nobreak > nul
echo          โ ุชู ุฅููุงู ุฌููุน ุงูุนูููุงุช
echo.

echo    [2/5] ุฅุนุฏุงุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช...
cd /d "%~dp0backend"
if exist "test-db-connection.js" (
    echo          ๐ ุงุฎุชุจุงุฑ ูุงุนุฏุฉ ุงูุจูุงูุงุช...
    node test-db-connection.js >nul 2>&1
    if exist "db-fixed.js" (
        copy db-fixed.js db.js >nul 2>&1
        echo          โ ุชู ุฅุตูุงุญ ุฅุนุฏุงุฏุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช
    )
)
echo.

echo    [3/5] ุชุดุบูู Backend...
start "๐ Backend Server" cmd /k "echo Backend Server ูุนูู ุนูู http://69.169.108.182:3000 && echo. && echo โ๏ธ ูุง ุชุบูู ูุฐู ุงููุงูุฐุฉ! && echo. && node server.js"
timeout /t 5 /nobreak > nul
echo          โ Backend ูุนูู
echo.

echo    [4/5] ุชุดุบูู Frontend...
cd /d "%~dp0auto-display-replicator-main"
start "๐จ Frontend" cmd /k "echo Frontend ูุนูู ุนูู http://localhost:8080 && echo. && echo โ๏ธ ูุง ุชุบูู ูุฐู ุงููุงูุฐุฉ! && echo. && npm run dev"
timeout /t 3 /nobreak > nul
echo          โ Frontend ูุนูู
echo.

echo    [5/5] ุงูุฅุตูุงุญุงุช ุงููุทุจูุฉ:
echo          โ ุฅุถุงูุฉ ูุญุต ุฅุถุงูู ููุตูุงุญูุงุช (role ุฃู is_admin)
echo          โ ุฑุณุงุฆู debug ููุตูุฉ ูู Frontend ู Backend
echo          โ ูุญุต ุฌููุน ุงูุญููู ุงูููููุฉ ูููุฏูุฑ
echo          โ ุชุญุณูู ุดุฑูุท ุงูุนุฑุถ
echo.

echo    โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo    โ                                                       โ
echo    โ              โ ุชู ุฅุตูุงุญ ุงููุดููุฉ!                    โ
echo    โ                                                       โ
echo    โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo.
echo    ๐ ุงูุฑูุงุจุท:
echo       โข Frontend: http://localhost:8080
echo       โข Backend:  http://69.169.108.182:3000
echo.
echo    ๐ ุจูุงูุงุช ุชุณุฌูู ุงูุฏุฎูู (ูุฏูุฑ):
echo       โข Email:    admin@example.com
echo       โข Password: admin123
echo.
echo    ๐ง ุงูุฅุตูุงุญุงุช ุงููุทุจูุฉ:
echo       โ ูุญุต ุฅุถุงูู: user.role === 'admin' OR user.is_admin === true
echo       โ ุฑุณุงุฆู debug ููุตูุฉ ูู Console
echo       โ ูุญุต ุฌููุน ุงูุญููู ุงูููููุฉ
echo       โ ุชุญุณูู ุดุฑูุท ุงูุนุฑุถ
echo.
echo    ๐ ุฎุทูุงุช ุงุฎุชุจุงุฑ ุงูุฅุตูุงุญ:
echo.
echo    ๐งช ุงุฎุชุจุงุฑ 1 - ุชุณุฌูู ุงูุฏุฎูู ููุฏูุฑ:
echo       1. ุงูุชุญ http://localhost:8080
echo       2. ุงุถุบุท ุนูู "Login"
echo       3. ุงุณุชุฎุฏู: admin@example.com / admin123
echo       4. ุงูุชุญ Developer Tools (F12) โ Console
echo       5. ุงุจุญุซ ุนู ุงูุฑุณุงุฆู:
echo          โข ๐ค ุชู ุชุญููู ุจูุงูุงุช ุงููุณุชุฎุฏู:
echo          โข ๐ ุฏูุฑ ุงููุณุชุฎุฏู: admin
echo          โข ๐ ุชูุงุตูู ุงููุณุชุฎุฏู:
echo          โข ๐ user.role: admin
echo          โข ๐ user.is_admin: true
echo.
echo    ๐งช ุงุฎุชุจุงุฑ 2 - ูุญุต ุงูุฃููููุงุช:
echo       1. ุงุถุบุท ุนูู ูุงุฆูุฉ ุงููุงูุจุฑุบุฑ (โฐ)
echo       2. ุงุฐูุจ ุฅูู ูุณู "Filtre"
echo       3. ุงููุชูุฌุฉ ุงููุชููุนุฉ: ุชุธูุฑ ุฃููููุงุช ุงูููู (โ๏ธ)
echo       4. ุงุถุบุท ุนูู ุฃููููุฉ ุงูููู
echo       5. ุงููุชูุฌุฉ ุงููุชููุนุฉ: ุชุธูุฑ ูุงุฌูุฉ ุงูุชุนุฏูู
echo.
echo    ๐ ุฑุณุงุฆู Debug ุงููุชููุนุฉ ูู Console:
echo       Frontend:
echo       โข ๐ค ุชู ุชุญููู ุจูุงูุงุช ุงููุณุชุฎุฏู: {role: "admin", is_admin: true}
echo       โข ๐ ุฏูุฑ ุงููุณุชุฎุฏู: admin
echo       โข ๐ ุชูุงุตูู ุงููุณุชุฎุฏู: {...}
echo       โข ๐ user.role: admin
echo       โข ๐ user.is_admin: true
echo       โข ๐ ูู ุงููุณุชุฎุฏู ูุฏูุฑุ true
echo.
echo       Backend (ูู ูุงูุฐุฉ Backend):
echo       โข ๐ ุจูุงูุงุช ุงููุณุชุฎุฏู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช: {...}
echo       โข ๐ ุจูุงูุงุช ุงููุณุชุฎุฏู ุงููุฑุณูุฉ ููุนููู: {...}
echo       โข ๐ is_admin: true
echo       โข ๐ role: admin
echo.
echo    ๐ฏ ุงููุชูุฌุฉ ุงููุชููุนุฉ:
echo       โ ุงูุฃููููุงุช ุชุธูุฑ ูููุฏูุฑูู
echo       โ ูุงุฌูุฉ ุงูุชุนุฏูู ุชุนูู
echo       โ ุฑุณุงุฆู debug ููุตูุฉ
echo.

timeout /t 3 /nobreak > nul
start http://localhost:8080

echo    ๐ ุชู ูุชุญ ุงููุชุตูุญ!
echo.
echo    ููููู ุฅุบูุงู ูุฐู ุงููุงูุฐุฉ ุงูุขู.
echo    ูุง ุชุบูู ุงููุงูุฐุชูู ุงูุฃุฎุฑููู (Backend ู Frontend)
echo.
pause
